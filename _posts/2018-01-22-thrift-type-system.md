---
layout: post
title: "Thrift 数据类型体系"
date: "2018-02-08"
description: "Thrift 数据类型体系"
tag: [thrift]
---

###　基本类型
- bool: 布尔值, true 或 false
- byte: 8 比特的有符号整数
- i16: 16 比特的有符号整数
- i32: 32 比特的有符号整数
- i64: 64 比特的有符号整数
- double: 64 比特的浮点数
- string: UTF-8 编码的字符串
### 特殊类型
- binary: 未编码的字节序列
这是上面的字符串类型的一种特殊形式, 增加了与Java的更好的互操作性, 当前的记录是在某一时刻将其提升为基本类型

### 结构体
Thrift 定义一个共用的实体, 基本与 OOP 语言中的类等效, 但是没有继承; 结构体有一系列强类型的字段, 每个都有唯一的命名标示符; 字段可以有多个注解 (整数的字段 id, 可选的默认值, 等等)

### 容器
Thrift 容器是强类型容器, 与大多数程序语言中的容器类型对应, 这有三种容器类型
- list: 一个有序的元素序列, 可转化为 STL 的 vector, Java 的 ArrayList, 脚本语言的原生数组, 等的
- set: 一个无序的唯一元素序列, 可转化为 STL 的 set, Java 的 HashSet, python 的 set, 等等; PHP 不支持 set, 会将其看做为一个 list
- map: 严格唯一键到值的映射, 可转化为 STL 的 map, Java 的 HashMap, PHP 的关联性 array, Python/Ruby 的 dictionary, 等等; 默认的类型映射没有明确被指定, 自定义的代码生成器指令会被添加, 允许替代各种语言中的自定义类型
容器元素必须是有效的 Thrift 类型  
附注: 为了最大的兼容性, 映射的键类型最好是基本类型而不是结构体或容器类型; 部分语言在它们的原生映射类型中不支持复杂的键类型; 另外, JSON 协议仅支持键为基本类型的映射

### 异常
异常和结构体在功能上等效, 除了它们可以从目标程序语言的原生异常基类中继承, 为了在任何语言中处理与原生异常的无缝整合

### 服务
使用 Thrift 类型定义服务, 服务的定义在语法上与面向对象语言中的接口定义 (或纯虚抽象类) 语法相同; Thrift 会生成全功能的客户端和实现接口的服务器桩  
服务包含了一系列的带着参数列表和返回值的函数
注意, 除了其他 Thrift 定义的所有类型, void 也是合法的函数返回类型; 此外, 单项修饰符关键字可以修饰到 void 函数, 这将生成非阻塞响应的代码; 注意, 一个纯 void 函数将返回响应到客户端, 这用于保证操作在服务端处理完成; 客户端调用单向方法仅保证请求成功发送到传输层, 同一个客户端调用的单向方法在服务端可能并行或无序的执行

>**参考:**
[Thrift Type System](https://thrift.apache.org/docs/types)
